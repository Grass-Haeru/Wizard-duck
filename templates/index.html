<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>Wizard duck's KWIC</title>
        <style>

            @media screen and (max-width: 600px) {
                .Container {
                    flex-direction: column;
                }

                .InputDetail {
                    width: 100%;
                    margin-bottom: 10px;
                }

                .Result {
                    width: 100%;
                }

                .SubmitButton{
                    flex-direction: column;   
                }
            }

            @media screen and (max-width: 850px) {
                #ChooseSearchTypes {
                    flex-direction: column; 
                    gap: 10px;
                    align-items: flex-start; 
                }
            }

            @media screen and (max-width: 1250px) {
                #ChooseMode {
                    flex-direction: column; 
                    gap: 10px;
                    align-items: flex-start; 
                }
            }
            
            .InputDetail{
            width: 40%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f1f1f1;
            box-sizing: border-box;
            margin-right: 10px;
            }

            .InputDetail label{
                display: block;
                margin-bottom: 5px;
                font-weight: bold;
            }

            /*↓Generated by ChatGPT↓*/
            .InputDetail select,
            .InputDetail input {
                width: 100%;
                padding: 8px;
                margin-bottom: 10px;
                border: 1px solid #ccc;
                border-radius: 5px;
                box-sizing: border-box;
            }
            /*↑Generated by ChatGPT↑*/

            .ChooseDetail label{
                margin-bottom: 5px;
                font-weight: bold;
            }

            .ResultContainer{
                flex-grow: 1;
                overflow-y: auto;
                padding: 10px;
            }

            
            .Token{
                font-size: 24px;
                color: red;
            }

            .POS{
                font-size: 24px;
                color: blue;
            }

            .Entity{
                font-size: 24px;
                color: green;
            }

            .SubmitButton button{
                width: 40%;
            }

            /*↓Generated by ChatGPT↓*/
            #ChooseSearchTypes{
                display: flex;
                gap: 30px;
                align-items: center;
            }

            #ChooseSearchTypes label{
                display: flex;
                align-items: center;
                gap: 5px;
                margin: 0;
            }

            #ChooseSearchTypes input[type="radio"] {
                vertical-align: middle;
                margin: 0;
            }

            #ChooseMode{
                display: flex;
                gap: 10px;
                align-items: center;
            }

            #ChooseMode label{
                display: flex;
                align-items: center;
                gap: 5px;
                margin: 0;
                font-size: 20px;
            }

            #ChooseMode input[type="radio"] {
                vertical-align: middle;
                margin: 0;
            }

            #Submit {
                background-color: #4CAF50;
                color: white;
                border: none;
                padding: 10px 20px;
                font-size: 30px;
                cursor: pointer;
            }

            #Submit:hover {
                background-color: #339938;  /* ホバー時に少し濃い緑 */
            }

            #Submit:active{
                background-color: #216424;
            }
            /*↑Generated by ChatGPT↑*/
        </style>
    </head>

    <body> 
        <div class="Container">
            <div class="InputDetail">
                <form id="InputInterest">
                    <label for="InputInterest">What's your Interest?</label>
                    <input type="text" id="Interest" placeholder="Input interest!">

                    <br></br>

                    <label for="ChooseSearchTypes">Search type</label>
                </form>  

                <form id="ChooseSearchTypes">
                    <label class="Token"><input type="radio" id="Token" name="SearchTypes" value="1" checked>Token</label>
                    <label class="POS"><input type="radio" id="POS" name="SearchTypes" value="2">POS</label>
                    <label class="Entity"><input type="radio" id="Entity" name="SearchTypes" value="3">Entity</label>
                </form>

                <br></br>

                <form id="ChoosePOS">
                    <label for="SelectPOS">Searched POS tags</label>
                    <select id="SelectPOS">
                        <option value="" selected disabled>Choose Pos tags!</option>
                        <option value="CC">CC: Coordinating conjunction</option>
                        <option value="CD">CD: Cardinal number</option>
                        <option value="DT">DT: Determiner</option>
                        <option value="EX">EX: Existential there</option>
                        <option value="FW">FW: Foreign word</option>
                        <option value="IN">IN: Preposition or subordinating conjunction</option>
                        <option value="JJ">JJ: Adjective</option>
                        <option value="JJR">JJR: Adjective, comparative</option>
                        <option value="JJS">JJS: Adjective, superlative</option>
                        <option value="LS">LS: List item marker</option>
                        <option value="MD">MD: Modal</option>
                        <option value="NN">NN: Noun, singular or mass</option>
                        <option value="NNS">NNS: Noun, plural</option>
                        <option value="NNP">NNP: Proper noun, singular</option>
                        <option value="NNPS">NNPS: Proper noun, plural</option>
                        <option value="PDT">PDT: Predeterminer</option>
                        <option value="POS">POS: Possessive ending</option>
                        <option value="PRP">PRP: Personal pronoun</option>
                        <option value="PRP$">PRP$: Possessive pronoun</option>
                        <option value="RB">RB: Adverb</option>
                        <option value="RBR">RBR: Adverb, comparative</option>
                        <option value="RBS">RBS: Adverb, superlative</option>
                        <option value="RP">RP: Particle</option>
                        <option value="SYM">SYM: Symbol</option>
                        <option value="TO">TO: to</option>
                        <option value="UH">UH: Interjection</option>
                        <option value="VB">VB: Verb, base form</option>
                        <option value="VBD">VBD: Verb, past tense</option>
                        <option value="VBG">VBG: Verb, gerund or present participle</option>
                        <option value="VBN">VBN: Verb, past participle</option>
                        <option value="VBP">VBP: Verb, non-3rd person singular present</option>
                        <option value="VBZ">VBZ: Verb, 3rd person singular present</option>
                        <option value="WDT">WDT: Wh-determiner</option>
                        <option value="WP">WP: Wh-pronoun</option>
                        <option value="WP$">WP$: Possessive wh-pronoun</option>
                        <option value="WRB">WRB: Wh-adverb</option>
                    </select>
                </form>
                
                <br></br>

                <form id="InputKW">
                    <label for="InputKW">Searched key word</label>
                    <input type="text" id="KW" placeholder="Input key word!"> 

                    <br></br>

                <label for="ChooseSearchTypes">Sort Mode</label>
                </form>

                <form id="ChooseMode">
                    <label><input type="radio" id="Sequential" name="SortMode" value="1" checked>Sequential</label>
                    <label><input type="radio" id="MostFreqToken" name="SortMode" value="2">Most&nbsp;freq&nbsp;token</label>
                    <label><input type="radio" id="MostFreqPOS" name="SortMode" value="3">Most&nbsp;freq&nbsp;POS</label>
                </form>

                <br></br>
                
                <form id="InputWindowSize">
                    <label for="InputWindowSize">Showed window size</label>
                    <span id="SizeValue">5</span>
                    <input type="range" id="WindowSize" name="WindowSize" min="1" max="10" step="1" value="5">
                </form>  

            </div>

            <br></br>

            <div class="SubmitButton" id="Button">
                <button type="submit" id="Submit">Submit</button>
            </div>

            <div class="Result" id="Result">
                <!-- It Shows result here. -->
            </div>
        </div>

        <script>
            const Window = document.getElementById("WindowSize");
            const SizeValue = document.getElementById("SizeValue");

            Window.addEventListener('input', function(){
                SizeValue.textContent=Window.value;
            });

            //↓Generated by ChatGPT↓
            window.addEventListener('DOMContentLoaded', () => {
            const submitButton = document.getElementById('Submit');
            submitButton.addEventListener('click', (event) => {
                event.preventDefault();

                const Interest = document.getElementById('Interest').value;

                const searchTypeElem = document.querySelector('input[name="SearchTypes"]:checked');
                const Operation = searchTypeElem ? parseInt(searchTypeElem.value, 10) : null;

                const POS = document.getElementById("SelectPOS").value;

                const Target = document.getElementById("KW").value;

                const modeElem = document.querySelector('input[name="SortMode"]:checked');
                const SortMode = modeElem ? parseInt(modeElem.value, 10) : null;

                const Window = parseInt(document.getElementById("WindowSize").value, 10);

                console.log({
                    Interest,
                    Operation,
                    POS,
                    Target,
                    SortMode,
                    Window,
                });

                if(!Interest){
                    alert('Please write "Interest"!');
                    return;
                }

                if(Operation==2 && !POS){
                    alert('Please choose "POS"!');
                    return;
                }

                if(!Target){
                    alert('Please write "KW"!');
                    return;
                }

                const formData= new FormData();
                formData.append('Interest',Interest);
                formData.append('Operation',Operation);
                formData.append('POS',POS);
                formData.append('Target',Target);
                formData.append('SortMode',SortMode);
                formData.append('Window',Window);

                fetch('/chat', {
                    method: 'POST',
                    body: formData
                })

                .then(response => response.json())

                .then(data => {
                    const resultContainer = document.getElementById('Result');
                    resultContainer.innerHTML = ''; // 既存の結果をクリア

                    // 返ってきたデータをそのまま整形して表示
                    resultContainer.textContent = JSON.stringify(data, null, 2);
                })

                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('Result').textContent = 'Error occurred while fetching results.';
                });
            });
        });
            //↑Generated by ChatGPT↑

        </script>
    </body>
</html>
